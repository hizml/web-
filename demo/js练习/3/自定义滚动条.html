<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<style>
*{ margin:0; padding:0}
.box{ width:300px; height:600px; margin:100px auto; border:5px solid #16CCD5; font-size:14px; font-family:"微软雅黑"; overflow:hidden; position:relative ; padding-bottom:2px;padding-top:2px;}
.box .op{ margin-right:23px; position:absolute; top:0; left:0; border-right:1px solid #16CCD5; } 
.scroll{ height:50px; width:20px; background-color:#1DF3EF; position:absolute; right:1px; top:1px; cursor:help;}
</style>
</head>

<body>
	<div class="box" id="box">
		<p>一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇一颗赛艇
	</p>
	</div>
</body>
</html>
<script src="../jq/jquery-1.11.3.min.js"></script>
<script src="../jq/hxsd_plugin.js"></script>
<script>
var box=$('#box');	//存储 减小性能消耗
var cont_h=box.children().eq(0).outerHeight();//p内容区实际高度
var box_h=box.height();//显示区盒子高度
if(cont_h>box_h){	//如果内容区大于显示区高度
	box.children().wrap('<div class="op"></div>');	//内容区包裹上一个具有margin-right属性的盒子撑开它
	var scrolll=$('<div class="scroll"></div>')	//在撑开区放置自定义滚动手柄
	var n_cont_h=box.children().eq(0).height();	//因为撑开后内容换行导致内容区高度增加 故 需计算内容区 新高度
	var h_rate=box_h/n_cont_h;	//比例 为 显示区高度除以 内容区实际新高度
	box.append(scrolll);	//页面塞入滚动
	var scroll_h=box_h*h_rate;	//滚动手柄高度为显示区高度*比例
	if(scroll_h<50){	//限制最小高度
		scroll_h=50;
	};
	if(cont_h==box_h){	//如果内容高度等于盒子高度  就删除那个滚动条
		box.remove(scrolll)
	}
	scrolll.height(scroll_h);// 将计算值 给滚动手柄高度
//==========================================================================	
	box.mouseWheel(function(dd){
	//var box_cont=$('#box .op')	
		if(dd){//下
/*			var t=box_cont.position().top-20;
			if(t<-(n_cont_h-box_h)){
				t=-(n_cont_h-box_h)
			}
			box_cont.css('top',t);*/
			var t=scrolll.position().top+20		//鼠标滚轮 直接调用滚动条 传值  每次滚动加20  鼠标滚轮距离他父级的高度
			move(t);
		}else{//上
/*			var t=box_cont.position().top+20;
			if(t>0){
				t=0
			}
			box_cont.css('top',t)*/		
			var t=scrolll.position().top-20
			move(t);
		}	
	})
};
//====================================================================
scrolll.mousedown(function(ev){	//滚动条 鼠标按下事件
	var disY=ev.pageY-$(this).position().top;	//鼠标y轴减去离有定位父级的top值  让鼠标记住他在滚动条的位置
	$(document).mousemove(function(ev){		//文档区 鼠标移动
		var t=ev.pageY-disY;		//定义t值 为鼠标y轴 减去 去掉父级距离的鼠标在滚动条内值   得出鼠标实际移动的值
		move(t);
	});
	$(document).mouseup(function(){
		$(document).unbind('mousemove');
	});
	return false;
})
function move(t){		//移动函数
	if(t<0){	//限定区域  上部
		t=0;
	};
	if(t>box_h-scroll_h){	//下部为 显示区盒子高度减去滚动条高度
		t=box_h-scroll_h;
	};
	scrolll.css('top',t);		//t值赋予滚动条top
	
	var move_rate=t/(box_h-scroll_h);	//内容区移动距离除以（显示区高度减去滚动条高度） 为倍数
	var tt=(box_h-n_cont_h)*move_rate				//内容区移动距离为负值   为倍数乘以 显示区高度减去实际撑开后的内容高度 
	
	$('#box .op').css('top',tt)
}
		















</script>